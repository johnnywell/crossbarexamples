<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
   <meta charset="utf-8" />

   <link rel="shortcut icon" href="../../img/favicon.ico">

   <title>BeatBox</title>

   <link rel="stylesheet" href="css/beatbox.css">

   <!-- Include Flash WebSocket via Conditional Comment:
        http://msdn.microsoft.com/en-us/library/ms537512%28v=vs.85%29.aspx -->
   <!--[if lte IE 9]>
      <script type="text/javascript">
        WEB_SOCKET_SWF_LOCATION = "../../flashws/WebSocketMain.swf";
      </script>
      <script type="text/javascript" src="../../flashws/swfobject.js"></script>
      <script type="text/javascript" src="../../flashws/web_socket.js"></script>
   <![endif]-->

   <script type="text/javascript" src="../../js/jquery.min.js"></script>
   <script>
      AUTOBAHN_DEBUG = true;
   </script>
   <script src="https://autobahn.s3.amazonaws.com/autobahnjs/latest/autobahn.min.jgz"></script>

   <script type="text/javascript" src="js/beatbox.js"></script>
</head>

<body>

   <header>
      <div id="header_inner">
         <div id="demo_title">
            <span>BeatBox</span>
         </div>
         <a class="navbar-brand" href="/">
            <img src="crossbar_icon_inverted.svg" alt="crossbar logo inverted" width="60" height="60">
            <img src="crossbar_demos_text_paths.svg" alt="crossbar logo inverted" width="248" height="60">
         </a>
      </div>
   </header>
   <div class="demo_links">
      <p>
         Trigger sound samples in any browse tab subscribed to the same channel.
      </p>
      <div>
         <a href="#" target="_blank" id="secondInstance">Open 2nd instance</a>
         <a href="https://github.com/crossbario/crossbarexamples/tree/master/demos/beatbox">
            Source Code
         </a>
         <a href="http://crossbar.io">
            Crossbar.io Homepage
         </a>
      </div>
      </div>

   <div id="demo_body">
      <div class="box box_left">

         <div class="box_heading">BeatBox Demo</div>

         <div class="box_content">

            <div class="beatbox_text_element">
               Enable Audio in this Browser: <input id="enable_audio" type="checkbox" {% if audio == 'on' %} checked {% endif %}>
            </div>

            <div class="beatbox_text_element">
               Controller Channel: <input type="text" id="controller-channel" size="6" maxlength="6"  value="{{channel}}">
               <button id="controller-channel-switch" class="button">Switch</button>
               <button id="controller-channel-cancel" class="button">Cancel</button>
            </div>


            <table id="beatbox_table" class="notextselect">
               <tr>
                  <td id="button-a" class="beatbox_pad_td">A
                  </td>
                  <td id="button-c" class="beatbox_pad_td">C
                  </td>
               </tr>
               <tr>
                  <td id="button-b" class="beatbox_pad_td">B
                  </td>
                  <td id="button-d" class="beatbox_pad_td">D
                  </td>
               </tr>
            </table>

            <div class="clearboth spacer_20"></div>

            <div class="beatbox_text_element">
               Trigger: &nbsp;
               Publish Event <input id="pub_trigger" type="checkbox" checked> &nbsp;
               Direct Mode <input id="direct_trigger" type="checkbox">
            </div>

            <div class="clearboth spacer_20"></div>

            <div id="beatbox_status_line" class="status_line">
               Status: <span class="statusline"></span>
            </div>

            <button id="helpButton" class="button">?</button>

         </div>

      </div>

      <div class="info_bar" style="display: none">

         <p class="info_bar_heading">This demo gives a good demonstration of the latencies involved in using Crossbar.io</p>
         <ul>
            <li>
               Control the playback of four different audio samples using the four controller pads (A - D). Pads can be controlled via keyboard ('A', 'B', 'C', 'D') as well. Audio playback requires browser support for HTML5 audio.
            </li>
            <li>
               All interactions on this demo occur in response to messages routed through the instance of Crossbar.io displayed in the status line at the bottom of the demo box.
            </li>
            <li>
               Works across several tabs or browsers by setting a common controller channel number in all instances.
            </li>
            <li>
               'Publish Event' toggles whether pad presses are routed through our hosted demo instance of Crossbar.io.
            </li>
            <li>
               In 'Direct Mode', samples are triggered directly instead of on receiving an event from the hosted demo instance of Crossbar.io.
            </li>
            <li>
               When testing in several browsers or tabs in parallel locally, enabling audio in only one browser avoids flanging due to slight cross-browser/tab delays in playback.
            </li>
            <li>
               With two local browser windows, triggering from one with both 'Publish Event' and 'Direct Mode' checked, and audio on in both audibly demonstrates the latency. We suggest using sample B for this.
            </li>

         </ul>

      </div>

   </div>

   <!-- community widget iframe -->

   <!-- general styles for the widget -->
   <link rel="stylesheet" type="text/css" href="https://demo.crossbar.io/clandeckwidget/css/parent.css" />

   <!-- local stylesheet -->
   <!--     - ensures non-Display if nothing loads -->
   <!--     - site-specific positioning of widget -->
   <style>
      #communityWidget.nonDisplay {
         display: none;
      }

      #communityWidget {
         top: 111px;
         right: 0px;
         box-shadow: 0 0 12px 2px rgba(0, 0, 0, 0.4);
      }
   </style>

   <!-- IFrame itself -->
   <iframe id="communityWidget" class="nonDisplay" src="https://demo.crossbar.io/clandeckwidget/index.html" frameborder="0"></iframe>

   <!-- the parent page connecting code -->
   <script src="https://demo.crossbar.io/clandeckwidget/js/parent.js"></script>


</body>
</html>
